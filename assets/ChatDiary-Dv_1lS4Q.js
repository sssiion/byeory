import{H as e,Nt as t,Q as n,jt as r,mt as i,wt as a,z as o}from"./index-D5xtHDuG.js";import{t as s}from"./Shared-CEi_3vw0.js";var c=t(r(),1),l=o();const u=({className:t,style:r,initialMessages:o=[],gridSize:u})=>{let[d,f]=(0,c.useState)(o.length>0?o:[{id:1,text:`오늘 하루는 어땠어?`,sender:`other`,time:`09:00`}]),[p,m]=(0,c.useState)(``),[h,g]=(0,c.useState)(!0),[_,v]=(0,c.useState)(!1),y=(0,c.useRef)(null),b=(0,c.useRef)(null);(0,c.useEffect)(()=>{y.current&&(y.current.scrollTop=y.current.scrollHeight)},[d]),(0,c.useEffect)(()=>{let e=e=>{b.current&&!b.current.contains(e.target)&&v(!1)};return _&&document.addEventListener(`mousedown`,e),()=>{document.removeEventListener(`mousedown`,e)}},[_]);let x=()=>{if(!p.trim())return;let e=new Date,t=`${e.getHours().toString().padStart(2,`0`)}:${e.getMinutes().toString().padStart(2,`0`)}`,n={id:Date.now(),text:p,sender:h?`me`:`other`,time:t};f([...d,n]),m(``),g(!h)};return(u?.w||2)<2&&(u?.h||2)<2?(0,l.jsx)(s,{className:`bg-[#bacee0] flex items-center justify-center h-full ${t||``}`,style:r,children:(0,l.jsxs)(`div`,{className:`flex flex-col items-center text-gray-600`,children:[(0,l.jsx)(`div`,{className:`w-8 h-8 rounded-[12px] bg-[#d6e4f0] flex items-center justify-center mb-1`,children:(0,l.jsx)(e,{size:16})}),(0,l.jsx)(`span`,{className:`text-[9px] font-bold`,children:`Chat`})]})}):(0,l.jsx)(s,{className:`bg-[#bacee0] ${t||``}`,style:r,children:(0,l.jsxs)(`div`,{className:`flex flex-col h-full`,children:[(0,l.jsxs)(`div`,{className:`flex items-center justify-between p-3 bg-[#bacee0] bg-opacity-90 z-10 relative`,children:[(0,l.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,l.jsx)(`div`,{className:`w-8 h-8 rounded-[12px] bg-[#d6e4f0] flex items-center justify-center text-gray-600`,children:(0,l.jsx)(e,{size:16})}),(0,l.jsxs)(`div`,{className:`flex flex-col`,children:[(0,l.jsx)(`span`,{className:`text-sm font-bold text-gray-800`,children:`나와의 채팅`}),(0,l.jsx)(`span`,{className:`text-[10px] text-gray-600`,children:`참여자 2`})]})]}),(0,l.jsxs)(`div`,{className:`relative`,ref:b,children:[(0,l.jsx)(`button`,{onClick:()=>v(!_),className:`p-1 hover:bg-[#a5bbcf] rounded-full transition-colors`,children:(0,l.jsx)(i,{size:16,className:`text-gray-600`})}),_&&(0,l.jsx)(`div`,{className:`absolute right-0 top-full mt-1 bg-white rounded-lg shadow-lg py-1 z-20 min-w-[100px] border border-gray-100`,children:(0,l.jsx)(`button`,{onClick:()=>{f([{id:1,text:`오늘 하루는 어땠어?`,sender:`other`,time:`09:00`}]),v(!1)},className:`w-full px-3 py-2 text-left text-xs text-red-500 hover:bg-red-50 flex items-center gap-2`,children:(0,l.jsx)(`span`,{className:`font-medium`,children:`초기화`})})})]})]}),(0,l.jsx)(`div`,{className:`flex-1 overflow-y-auto p-3 flex flex-col gap-3 custom-scrollbar`,ref:y,children:d.map(e=>(0,l.jsxs)(`div`,{className:`flex gap-2 max-w-[85%] ${e.sender===`me`?`self-end flex-row-reverse`:`self-start`}`,children:[e.sender===`other`&&(0,l.jsx)(`div`,{className:`w-8 h-8 rounded-[12px] bg-white flex-shrink-0 flex items-center justify-center shadow-sm overflow-hidden mt-1`,children:(0,l.jsx)(a,{size:18,className:`text-[#5b3c3c]`})}),(0,l.jsx)(`div`,{className:`flex flex-col ${e.sender===`me`?`items-end`:`items-start`}`,children:(0,l.jsxs)(`div`,{className:`flex items-end gap-1`,children:[e.sender===`me`&&(0,l.jsx)(`span`,{className:`text-[10px] text-gray-500 min-w-fit mb-1`,children:e.time}),(0,l.jsx)(`div`,{className:`px-3 py-2 rounded-[12px] text-sm shadow-sm break-words ${e.sender===`me`?`bg-[#ffeb3b] text-black rounded-tr-[4px]`:`bg-white text-black rounded-tl-[4px]`}`,children:e.text}),e.sender===`other`&&(0,l.jsx)(`span`,{className:`text-[10px] text-gray-500 min-w-fit mb-1`,children:e.time})]})})]},e.id))}),(0,l.jsx)(`div`,{className:`p-3 bg-white`,children:(0,l.jsxs)(`div`,{className:`flex gap-2 bg-[#f3f3f3] rounded-[18px] px-3 py-2 items-center`,children:[(0,l.jsx)(`div`,{className:`cursor-pointer text-gray-400 hover:text-gray-600 transition-colors`,onClick:()=>g(!h),title:h?`Switch to Narrator`:`Switch to Me`,children:h?(0,l.jsx)(e,{size:16}):(0,l.jsx)(a,{size:16})}),(0,l.jsx)(`input`,{className:`flex-1 bg-transparent border-none outline-none text-sm text-gray-800 placeholder-gray-400`,placeholder:`메시지 입력...`,value:p,onChange:e=>m(e.target.value),onKeyDown:e=>{e.key===`Enter`&&!e.shiftKey&&(e.preventDefault(),x())}}),(0,l.jsx)(`button`,{onClick:x,className:`p-1.5 rounded-full transition-colors ${p.trim()?`bg-[#ffeb3b] text-black`:`bg-gray-200 text-gray-400`}`,children:(0,l.jsx)(n,{size:14})})]})})]})})};export{u as ChatDiary};
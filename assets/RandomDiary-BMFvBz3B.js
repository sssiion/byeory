import{At as e,Nt as t,Ot as n,Tt as r,V as i,ft as a,jt as o,kt as s,tt as c,xt as l,y as u,z as d}from"./index-D5xtHDuG.js";import{t as f}from"./Shared-CEi_3vw0.js";var p=n(`shuffle`,[[`path`,{d:`m18 14 4 4-4 4`,key:`10pe0f`}],[`path`,{d:`m18 2 4 4-4 4`,key:`pucp1d`}],[`path`,{d:`M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22`,key:`1ailkh`}],[`path`,{d:`M2 6h1.972a4 4 0 0 1 3.6 2.2`,key:`km57vx`}],[`path`,{d:`M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45`,key:`os18l9`}]]),m=t(o(),1),h=t(e(),1),g=d();const _=({className:e,style:t,gridSize:n,isStickerMode:o})=>{let d=s(),[_,v]=(0,m.useState)([]),[y,b]=(0,m.useState)(null),[x,S]=(0,m.useState)(!0),[C,w]=(0,m.useState)(!1),[T,E]=(0,m.useState)(!1),D=(n?.w||1)>=2&&(n?.h||1)>=2;(0,m.useEffect)(()=>{(async()=>{S(!0);try{v(await u())}catch(e){console.error(`Failed to load posts:`,e)}finally{S(!1)}})()},[]);let O=(0,m.useCallback)(()=>{_.length!==0&&(b(_[Math.floor(Math.random()*_.length)]),D?E(!0):w(!0))},[_,D]),k=()=>{y&&!o&&(w(!1),d(`/post?id=${y.id}`))},A=e=>{if(!e.blocks||e.blocks.length===0)return``;let t=e.blocks.find(e=>e.type===`text`||e.type===`paragraph`);return t?.text?t.text.slice(0,80)+(t.text.length>80?`...`:``):``},j=e=>e?new Date(e).toLocaleDateString(`ko-KR`,{year:`numeric`,month:`short`,day:`numeric`}):``;return x?(0,g.jsx)(f,{className:`theme-bg-card ${e||``}`,style:t,children:(0,g.jsx)(`div`,{className:`flex items-center justify-center h-full`,children:(0,g.jsx)(c,{className:`w-5 h-5 animate-spin`,style:{color:`var(--text-secondary)`}})})}):_.length===0?(0,g.jsx)(f,{className:`theme-bg-card ${e||``}`,style:t,children:(0,g.jsxs)(`div`,{className:`flex flex-col items-center justify-center h-full gap-2 p-4 text-center`,children:[(0,g.jsx)(a,{className:`w-8 h-8 opacity-50`,style:{color:`var(--text-secondary)`}}),(0,g.jsx)(`p`,{className:`text-xs`,style:{color:`var(--text-secondary)`},children:`아직 작성된 일기가 없어요`})]})}):D?(0,g.jsx)(f,{className:`theme-bg-card ${e||``}`,style:t,children:(0,g.jsx)(`div`,{className:`flex flex-col h-full p-4`,children:T?(0,g.jsxs)(`div`,{className:`flex flex-col h-full`,children:[(0,g.jsxs)(`div`,{className:`flex-1 flex flex-col justify-center`,children:[(0,g.jsx)(`p`,{className:`text-xs mb-3 text-center`,style:{color:`var(--text-secondary)`},children:`전에 써둔 기록물을 검토해보세요`}),(0,g.jsxs)(`div`,{className:`p-4 rounded-xl`,style:{backgroundColor:`var(--bg-card-secondary)`,border:`1px solid var(--border-color)`},children:[(0,g.jsx)(`h3`,{className:`font-bold text-sm mb-1 truncate`,style:{color:`var(--text-primary)`},children:y?.title||`제목 없음`}),(0,g.jsx)(`p`,{className:`text-xs mb-2`,style:{color:`var(--text-secondary)`},children:j(y?.date)}),(0,g.jsx)(`p`,{className:`text-xs line-clamp-2`,style:{color:`var(--text-secondary)`},children:A(y)||`내용 미리보기가 없습니다.`})]})]}),(0,g.jsxs)(`div`,{className:`flex gap-2 mt-4`,children:[(0,g.jsxs)(`button`,{onClick:O,className:`flex-1 py-2.5 rounded-xl text-sm font-medium transition-colors flex items-center justify-center gap-2`,style:{backgroundColor:`var(--bg-card-secondary)`,color:`var(--text-secondary)`,border:`1px solid var(--border-color)`},children:[(0,g.jsx)(c,{className:`w-4 h-4`}),`다시뽑기`]}),(0,g.jsxs)(`button`,{onClick:k,className:`flex-1 py-2.5 rounded-xl text-sm font-medium transition-colors flex items-center justify-center gap-2 hover:opacity-90`,style:{backgroundColor:`var(--btn-bg)`,color:`var(--btn-text)`},children:[(0,g.jsx)(r,{className:`w-4 h-4`}),`보기`]})]})]}):(0,g.jsxs)(`div`,{className:`flex flex-col items-center justify-center h-full gap-4`,children:[(0,g.jsx)(`div`,{className:`p-4 rounded-full`,style:{backgroundColor:`color-mix(in srgb, var(--btn-bg) 15%, transparent)`},children:(0,g.jsx)(p,{className:`w-10 h-10`,style:{color:`var(--icon-color)`}})}),(0,g.jsxs)(`div`,{className:`text-center`,children:[(0,g.jsx)(`p`,{className:`text-sm font-medium mb-1`,style:{color:`var(--text-primary)`},children:`과거의 기록을 꺼내볼까요?`}),(0,g.jsxs)(`p`,{className:`text-xs`,style:{color:`var(--text-secondary)`},children:[_.length,`개의 일기 중 하나를 뽑아드려요`]})]}),(0,g.jsx)(`button`,{onClick:O,className:`px-6 py-2.5 rounded-xl text-sm font-bold transition-all hover:scale-105 active:scale-95 shadow-lg hover:opacity-90`,style:{backgroundColor:`var(--btn-bg)`,color:`var(--btn-text)`},children:`뽑기`})]})})}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(f,{className:`theme-bg-card ${e||``}`,style:t,children:(0,g.jsxs)(`div`,{className:`flex flex-col items-center justify-center h-full gap-3 p-3`,children:[(0,g.jsxs)(`div`,{className:`text-center`,children:[(0,g.jsx)(p,{className:`w-6 h-6 mx-auto mb-2`,style:{color:`var(--icon-color)`}}),(0,g.jsxs)(`p`,{className:`text-[10px] leading-tight`,style:{color:`var(--text-secondary)`},children:[`무작위로`,(0,g.jsx)(`br`,{}),`일기를 뽑아봐요`]})]}),(0,g.jsx)(`button`,{onClick:O,className:`px-4 py-1.5 rounded-lg text-xs font-bold transition-all hover:scale-105 active:scale-95 hover:opacity-90`,style:{backgroundColor:`var(--btn-bg)`,color:`var(--btn-text)`},children:`뽑기`})]})}),C&&h.createPortal((0,g.jsx)(()=>(0,g.jsx)(`div`,{className:`fixed inset-0 z-[9999] flex items-center justify-center`,style:{backgroundColor:`rgba(0, 0, 0, 0.5)`,backdropFilter:`blur(4px)`},onClick:()=>w(!1),children:(0,g.jsxs)(`div`,{className:`rounded-2xl shadow-2xl max-w-sm w-[90%] mx-4 overflow-hidden`,style:{backgroundColor:`var(--bg-modal)`,backdropFilter:`blur(10px)`},onClick:e=>e.stopPropagation(),children:[(0,g.jsxs)(`div`,{className:`flex items-center justify-between px-4 py-3`,style:{borderBottom:`1px solid var(--border-color)`,backgroundColor:`var(--bg-card-secondary)`},children:[(0,g.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,g.jsx)(r,{className:`w-4 h-4`,style:{color:`var(--icon-color)`}}),(0,g.jsx)(`span`,{className:`text-sm font-bold`,style:{color:`var(--text-primary)`},children:`뽑힌 일기`})]}),(0,g.jsx)(`button`,{onClick:()=>w(!1),className:`p-1 rounded-lg transition-colors hover:opacity-70`,children:(0,g.jsx)(i,{className:`w-4 h-4`,style:{color:`var(--text-secondary)`}})})]}),(0,g.jsx)(`div`,{className:`p-4`,children:y?(0,g.jsxs)(`div`,{className:`space-y-3`,children:[(0,g.jsxs)(`div`,{children:[(0,g.jsx)(`h3`,{className:`font-bold text-base mb-1`,style:{color:`var(--text-primary)`},children:y.title||`제목 없음`}),(0,g.jsx)(`p`,{className:`text-xs`,style:{color:`var(--text-secondary)`},children:j(y.date)})]}),(0,g.jsx)(`p`,{className:`text-sm leading-relaxed`,style:{color:`var(--text-secondary)`},children:A(y)||`내용 미리보기가 없습니다.`}),y.tags&&y.tags.length>0&&(0,g.jsx)(`div`,{className:`flex flex-wrap gap-1`,children:y.tags.slice(0,3).map((e,t)=>(0,g.jsxs)(`span`,{className:`px-2 py-0.5 text-[10px] rounded-full`,style:{backgroundColor:`var(--btn-bg)`,color:`var(--btn-text)`,opacity:.8},children:[`#`,e]},t))})]}):(0,g.jsx)(`p`,{className:`text-sm`,style:{color:`var(--text-secondary)`},children:`선택된 일기가 없습니다.`})}),(0,g.jsxs)(`div`,{className:`flex gap-2 p-4 pt-0`,children:[(0,g.jsxs)(`button`,{onClick:O,className:`flex-1 py-2.5 px-3 rounded-xl text-sm font-medium transition-colors flex items-center justify-center gap-2`,style:{backgroundColor:`var(--bg-card-secondary)`,color:`var(--text-secondary)`,border:`1px solid var(--border-color)`},children:[(0,g.jsx)(c,{className:`w-4 h-4`}),`다시 뽑기`]}),(0,g.jsxs)(`button`,{onClick:k,className:`flex-1 py-2.5 px-3 rounded-xl text-sm font-medium transition-colors flex items-center justify-center gap-2 hover:opacity-90`,style:{backgroundColor:`var(--btn-bg)`,color:`var(--btn-text)`},children:[`보러가기`,(0,g.jsx)(l,{className:`w-4 h-4`})]})]})]})}),{}),document.body)]})};export{_ as RandomDiary};
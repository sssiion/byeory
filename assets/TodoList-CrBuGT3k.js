import{St as e,jt as t,kt as n,nt as r,t as i,z as a}from"./index-D5xtHDuG.js";import{t as o}from"./Shared-CEi_3vw0.js";var s=t(),c=a();function l({gridSize:t,isStickerMode:a}){let l=n(),{getTodayTodos:u,addTodo:d,toggleTodo:f}=i(),[p,m]=(0,s.useState)(``),[h,g]=(0,s.useState)(!1),_=u(),v=_.filter(e=>e.completed),y=_.length,b=v.length,x=y>0?b/y*100:0,S=x===100?`bg-green-500`:`bg-[var(--btn-bg)]`,C=()=>{a||l(`/todo`)};(0,s.useEffect)(()=>{if(y>0&&b===y){let e=new Date,t=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,`0`)}-${String(e.getDate()).padStart(2,`0`)}`;window.dispatchEvent(new CustomEvent(`todo-all-completed`,{detail:{date:t}}))}},[y,b]);let w=()=>{if(!p.trim())return;let e=new Date().toISOString().split(`T`)[0];d({title:p,completed:!1,startDate:e,endDate:e,allDay:!0}),m(``),g(!1)};return(t?.w||2)<2?(0,c.jsx)(o,{className:`theme-bg-card cursor-pointer`,onClick:C,children:(0,c.jsxs)(`div`,{className:`flex flex-col items-center justify-center h-full relative`,children:[(0,c.jsxs)(`div`,{className:`relative w-16 h-16 flex items-center justify-center`,children:[(0,c.jsxs)(`svg`,{className:`w-full h-full transform -rotate-90`,children:[(0,c.jsx)(`circle`,{cx:`32`,cy:`32`,r:`28`,stroke:`currentColor`,strokeWidth:`4`,fill:`transparent`,className:`theme-text-secondary opacity-20`}),(0,c.jsx)(`circle`,{cx:`32`,cy:`32`,r:`28`,stroke:`currentColor`,strokeWidth:`4`,fill:`transparent`,className:`${x===100?`text-green-500`:`text-[var(--btn-bg)]`} transition-all duration-1000 ease-out`,strokeDasharray:175.9,strokeDashoffset:175.9-x/100*175.9})]}),(0,c.jsx)(`div`,{className:`absolute inset-0 flex flex-col items-center justify-center`,children:(0,c.jsxs)(`span`,{className:`text-sm font-bold theme-text-primary`,children:[Math.round(x),`%`]})})]}),(0,c.jsxs)(`span`,{className:`text-[10px] theme-text-secondary mt-2 font-medium`,children:[b,`/`,y,` Tasks`]})]})}):(0,c.jsx)(o,{title:`TODAY'S TASKS`,className:`theme-bg-card`,headerRight:(0,c.jsx)(`div`,{className:`text-xs font-bold theme-text-secondary cursor-pointer hover:text-[var(--btn-bg)] uppercase tracking-wide`,onClick:C,children:`VIEW ALL`}),children:(0,c.jsxs)(`div`,{className:`flex flex-col h-full overflow-hidden`,children:[(0,c.jsx)(`div`,{className:`px-3 pt-2 pb-1`,children:(0,c.jsx)(`div`,{className:`w-full h-1.5 theme-bg-card-secondary rounded-full overflow-hidden`,children:(0,c.jsx)(`div`,{className:`h-full ${S} transition-all duration-500 ease-out`,style:{width:`${x}%`}})})}),(0,c.jsxs)(`div`,{className:`flex-1 overflow-y-auto p-2 custom-scrollbar`,children:[_.length===0&&(0,c.jsxs)(`div`,{className:`flex flex-col items-center justify-center h-full theme-text-secondary gap-2 opacity-50`,children:[(0,c.jsx)(e,{size:24}),(0,c.jsx)(`span`,{className:`text-xs`,children:`No tasks for today!`})]}),(0,c.jsx)(`div`,{className:`space-y-2`,children:_.slice(0,(t?.h||2)<2?3:10).map(t=>(0,c.jsxs)(`div`,{className:`flex items-center gap-3 p-3 rounded-xl theme-bg-card-secondary border theme-border transition-all hover:brightness-95 ${t.completed?`opacity-60`:``}`,children:[(0,c.jsx)(`button`,{onClick:()=>f(t.id),className:`flex-shrink-0 theme-text-secondary hover:text-[var(--btn-bg)] transition-colors`,style:{color:t.completed?`var(--btn-bg)`:void 0},children:t.completed?(0,c.jsx)(e,{size:18,className:`stroke-[3]`}):(0,c.jsx)(`div`,{className:`w-[18px] h-[18px] rounded-full border-2 border-current opacity-50`})}),(0,c.jsxs)(`div`,{className:`flex-1 min-w-0 flex items-center gap-2`,children:[(0,c.jsx)(`span`,{className:`text-sm font-medium truncate ${t.completed?`line-through theme-text-secondary`:`theme-text-primary`}`,children:t.title}),!t.allDay&&(0,c.jsxs)(`span`,{className:`text-xs theme-text-secondary whitespace-nowrap`,children:[`- `,t.startTime]})]})]},t.id))})]}),(t?.h||2)>=2&&(0,c.jsx)(`div`,{className:`p-2 border-t theme-border mt-auto`,children:h?(0,c.jsxs)(`div`,{className:`flex gap-2 items-center animate-in slide-in-from-bottom-2 duration-200`,children:[(0,c.jsx)(`input`,{autoFocus:!0,value:p,onChange:e=>m(e.target.value),onKeyDown:e=>e.key===`Enter`&&w(),placeholder:`New task...`,className:`flex-1 text-sm bg-transparent outline-none min-w-0 theme-text-primary placeholder:text-gray-400 py-2`}),(0,c.jsx)(`button`,{onClick:w,className:`p-2 rounded bg-[var(--btn-bg)] text-white hover:opacity-90 transition-opacity`,children:(0,c.jsx)(r,{size:18})})]}):(0,c.jsxs)(`button`,{onClick:()=>g(!0),className:`w-full flex items-center justify-center gap-2 py-3 rounded-lg border border-dashed theme-border text-sm theme-text-secondary hover:text-[var(--btn-bg)] hover:border-[var(--btn-bg)] hover:bg-[var(--btn-bg)] hover:bg-opacity-5 transition-all`,children:[(0,c.jsx)(r,{size:16}),(0,c.jsx)(`span`,{children:`Add Task`})]})})]})})}export{l as TodoListWidget};
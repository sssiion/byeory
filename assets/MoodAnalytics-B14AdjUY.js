import{Dt as e,Nt as t,jt as n,kt as r,tt as i,z as a}from"./index-D5xtHDuG.js";import{t as o}from"./Shared-CEi_3vw0.js";var s=t(n(),1),c=a();const l=({className:t,style:n,gridSize:a,isStickerMode:l})=>{let u=r(),[d,f]=(0,s.useState)([]),[p,m]=(0,s.useState)(!0),[h,g]=(0,s.useState)(!1),_=async()=>{m(!0);let e=localStorage.getItem(`accessToken`);if(!e){m(!1);return}try{let t=await fetch(`/api/persona`,{headers:{Authorization:`Bearer ${e}`}});if(t.status===404){f([]);return}if(t.ok&&t.status!==204){let e=await t.json(),n=e;if(typeof e.analysisResult==`string`)try{n=JSON.parse(e.analysisResult)}catch{}n&&n.moods?f(n.moods):f([])}else f([])}catch{g(!0),f([])}finally{m(!1)}};(0,s.useEffect)(()=>{_()},[]);let v=(a?.w||2)===1&&(a?.h||1)===1,y=0,b=2*Math.PI*16,x=[`#86efac`,`#fde047`,`#fca5a5`,`#93c5fd`,`#c4b5fd`];return p?(0,c.jsx)(o,{className:`bg-white ${t||``}`,style:n,children:(0,c.jsx)(`div`,{className:`flex items-center justify-center h-full text-gray-400`,children:(0,c.jsx)(i,{className:`animate-spin w-5 h-5`})})}):h||d.length===0?(0,c.jsx)(o,{className:`bg-white ${t||``}`,style:n,title:`Moods`,children:(0,c.jsxs)(`div`,{className:`flex flex-col items-center justify-center h-full text-center gap-3 p-4`,children:[(0,c.jsxs)(`div`,{className:`flex flex-col items-center gap-1`,children:[(0,c.jsx)(e,{className:`w-8 h-8 text-indigo-300 opacity-50`}),(0,c.jsx)(`span`,{className:`text-xs text-gray-400 font-medium`,children:`분석된 기분이 없어요`})]}),(0,c.jsx)(`button`,{onClick:()=>!l&&u(`/profile/analysis`),className:`px-3 py-1.5 bg-indigo-50 hover:bg-indigo-100 text-indigo-600 text-[10px] font-bold rounded-lg transition-colors flex items-center gap-1`,children:`분석하러 가기`})]})}):(0,c.jsx)(o,{className:`bg-white ${t||``}`,style:n,children:(0,c.jsxs)(`div`,{className:`flex items-center h-full w-full ${v?`p-2 py-3`:`p-4 px-15 scale-110 origin-center`}`,children:[(0,c.jsxs)(`div`,{className:`relative shrink-0 flex items-center justify-center ${v?`w-[42%] aspect-square`:`w-24 h-24 mr-4`}`,children:[(0,c.jsx)(`svg`,{viewBox:`0 0 40 40`,className:`w-full h-full transform -rotate-90 drop-shadow-sm`,children:d.map((e,t)=>{let n=`${e.percentage/100*b} ${b}`,r=-(y/100*b);return y+=e.percentage,(0,c.jsx)(`circle`,{cx:`20`,cy:`20`,r:16,fill:`transparent`,stroke:x[t%x.length],strokeWidth:`6`,strokeDasharray:n,strokeDashoffset:r,strokeLinecap:`round`,className:`transition-all duration-1000 ease-out`},t)})}),(0,c.jsx)(`div`,{className:`absolute inset-0 flex items-center justify-center`,children:(0,c.jsx)(`span`,{className:`${v?`text-2xl`:`text-3xl`} pb-1`,children:d[0]?.emoji})})]}),(0,c.jsxs)(`div`,{className:`flex flex-col justify-center flex-1 min-w-0 ${v?`pl-2`:``}`,children:[(0,c.jsx)(`div`,{className:`font-bold text-gray-400 uppercase tracking-widest mb-1.5 ${v?`text-[8px]`:`text-[10px]`}`,children:`Top Emotions`}),(0,c.jsx)(`div`,{className:`flex flex-col gap-1.5 w-full`,children:d.slice(0,3).map((e,t)=>(0,c.jsxs)(`div`,{className:`flex items-center justify-between w-full`,children:[(0,c.jsxs)(`div`,{className:`flex items-center gap-1.5 min-w-0 flex-1`,children:[(0,c.jsx)(`span`,{className:`rounded-full shrink-0 ${v?`w-2 h-2`:`w-2.5 h-2.5`}`,style:{backgroundColor:x[t%x.length]}}),(0,c.jsx)(`span`,{className:`font-bold text-slate-700 truncate ${v?`text-[10px]`:`text-xs`}`,children:e.mood})]}),(0,c.jsxs)(`span`,{className:`text-gray-400 font-medium ${v?`text-[9px]`:`text-xs`}`,children:[e.percentage,`%`]})]},t))})]})]})})};export{l as MoodAnalytics};